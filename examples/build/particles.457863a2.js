parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"dldi":[function(require,module,exports) {
"use strict";var t=this&&this.__assign||function(){return(t=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.val=exports.source=exports.TypeMap=exports.Glsl=exports.GlslBuilder=exports.Precision=exports.Type=void 0;var n,e,r=function(){var t=0;return function(){return t++}}();!function(t){t.Scalar="float",t.Vector2="vec2",t.Matrix2="mat2",t.Vector3="vec3",t.Matrix3="mat3",t.Vector4="vec4",t.Matrix4="mat4",t.Boolean="bool",t.Sampler="sampler2D"}(n=exports.Type||(exports.Type={})),function(t){t.High="highp",t.Medium="mediump",t.Low="lowp"}(e=exports.Precision||(exports.Precision={})),function(t){t.size=function(n){switch(n){case t.Boolean:case t.Scalar:case t.Sampler:return 1;case t.Vector2:case t.Matrix2:return 2;case t.Vector3:case t.Matrix3:return 3;case t.Vector4:case t.Matrix4:return 4}},t.vector=function(n){switch(n){case 2:return t.Vector2;case 3:return t.Vector3;case 4:return t.Vector4}},t.numeric=function(n){switch(n){case 1:return t.Scalar;case 2:return t.Vector2;case 3:return t.Vector3;case 4:return t.Vector4}},t.isVector=function(n){return n===t.Vector2||n===t.Vector3||n===t.Vector4},t.isMatrix=function(n){return n===t.Matrix2||n===t.Matrix3||n===t.Matrix4}}(n=exports.Type||(exports.Type={}));var o=function(){function t(t){void 0===t&&(t=new Map),this.cache=t,this.global="",this.local=""}return t.prototype.once=function(t,n){if(this.cache.has(t))return this.cache.get(t);var e=n();return this.cache.set(t,e),e},t.prototype.getGlobal=function(){return this.global},t.prototype.addGlobal=function(t){return this.global+=t,this},t.prototype.getLocal=function(){return this.local},t.prototype.addLocal=function(t){return this.local+=t,this},t.prototype.child=function(){return new t(this.cache)},t}();exports.GlslBuilder=o;var u,c="==+-*/<><=>=!&&||",i=function(){function t(e){this.getValue=e,this.sin=t.unary("sin"),this.cos=t.unary("cos"),this.radians=t.unary("radians"),this.degrees=t.unary("degrees"),this.tan=t.unary("tan"),this.asin=t.unary("asin"),this.acos=t.unary("acos"),this.exp=t.unary("exp"),this.log=t.unary("log"),this.exp2=t.unary("exp2"),this.log2=t.unary("log2"),this.sqrt=t.unary("sqrt"),this.inversesqrt=t.unary("inversesqrt"),this.abs=t.unary("abs"),this.sign=t.unary("sign"),this.floor=t.unary("floor"),this.ceil=t.unary("floor"),this.fract=t.unary("fract"),this.normalize=t.unary("normalize"),this.not=t.unary("!"),this.texture2D=function(e){return t.call("texture2D",[this,e],function(){return n.Vector4})},this.lt=t.bool("<"),this.gt=t.bool(">"),this.lte=t.bool("<="),this.gte=t.bool(">="),this.eq=t.bool("=="),this.neq=t.bool("!=")}return t.call=function(n,e,r){var o=-1!==c.indexOf(n),u=e.map(function(t){return"number"==typeof t?exports.val(t):t});return 2===e.length&&o?new t(function(t){var e=u.map(function(n){return n.getValue(t)});return{type:r(e.map(function(t){return t.type})),content:"(("+e[0].content+") "+n+" ("+e[1].content+"))"}}):new t(function(t){var e=u.map(function(n){return n.getValue(t)});return{type:r(e.map(function(t){return t.type})),content:n+"("+e.map(function(t){return t.content}).join(", ")+")"}})},t.unary=function(n){return function(){return t.call(n,[this],function(t){return t[0]})}},t.prototype.round=function(){return this.add(.5).floor()},t.prototype.atan=function(n){return void 0===n?t.call("atan",[this],function(t){return t[0]}):t.call("atan",[this,n],function(t){return t[0]})},t.prototype.pow=function(n){var e="number"==typeof n?exports.val(n):n;return t.call("pow",[this,e],function(t){return t[0]})},t.prototype.mod=function(n){var e="number"==typeof n?exports.val(n):n;return t.call("mod",[this,e],function(t){return t[0]})},t.prototype.min=function(n){var e="number"==typeof n?exports.val(n):n;return t.call("min",[this,e],function(t){return t[0]})},t.prototype.max=function(n){return t.call("max",[this,n],function(t){return t[0]})},t.prototype.mix=function(n,e){return t.call("mix",[this,n,e],function(t){return t[0]})},t.prototype.clamp=function(n,e){return t.call("clamp",[this,n,e],function(t){return t[0]})},t.prototype.smoothstep=function(n,e){return t.call("smoothstep",[n,e,this],function(t){return t[0]})},t.prototype.length=function(){return t.call("length",[this],function(){return n.Scalar})},t.prototype.distance=function(e){return t.call("distance",[this,e],function(){return n.Scalar})},t.prototype.dot=function(e){return t.call("dot",[this,e],function(){return n.Scalar})},t.prototype.reflect=function(n){return t.call("reflect",[this,n],function(t){return t[0]})},t.prototype.refract=function(n,e){return t.call("refract",[this,n,e],function(t){return t[0]})},t.prototype.add=function(e){return t.call("+",[this,e],function(t){var e=t[0],r=t[1];return e===n.Scalar?r:e})},t.prototype.sub=function(e){return t.call("-",[this,e],function(t){var e=t[0],r=t[1];return e===n.Scalar?r:e})},t.prototype.div=function(e){return t.call("/",[this,e],function(t){var e=t[0],r=t[1];return e===n.Scalar?r:e})},t.prototype.mul=function(e){return t.call("*",[this,e],function(t){var e=t[0],r=t[1];return e===n.Scalar||e===r?r:r===n.Scalar?e:n.isVector(e)?e:n.isVector(r)?r:e})},t.bool=function(e){return function(r){return t.call(e,[this,r],function(){return n.Boolean})}},t.prototype.and=function(e){return t.call("&&",[this,e],function(){return n.Boolean})},t.prototype.or=function(e){return t.call("||",[this,e],function(){return n.Boolean})},t.prototype.mem=function(n){var e=this,o="mem"+r();return new t(function(t){var r=e.getValue(t);return t.once(o,function(){t.addLocal(n+" "+r.type+" "+o+" = "+r.content+";\n")}),{type:r.type,content:o}})},t.prototype.memHQ=function(){return this.mem(e.High)},t.prototype.memMQ=function(){return this.mem(e.Medium)},t.prototype.memLQ=function(){return this.mem(e.Low)},t.prototype.cond=function(e,o,u){var c=this,i="cond"+r(),a=null;return new t(function(t){return t.once(i,function(){var r=t.child(),s=o.getValue(r),l=t.child(),p=u.getValue(l),f=c.getValue(t);a=s.type,t.addGlobal(r.getGlobal()).addGlobal(l.getGlobal()),t.addLocal((s.type!==n.Boolean?e+" ":"")+s.type+" "+i+";\n").addLocal("if ("+f.content+") {\n").addLocal(r.getLocal()).addLocal(i+" = "+s.content+";\n").addLocal("} else {\n").addLocal(l.getLocal()).addLocal(i+" = "+p.content+";\n").addLocal("}\n")}),{type:a,content:i}})},t.prototype.condHQ=function(t,n){return this.cond(e.High,t,n)},t.prototype.condMQ=function(t,n){return this.cond(e.Medium,t,n)},t.prototype.condLQ=function(t,n){return this.cond(e.Low,t,n)},t.prototype.take=function(e,r,o,u){var c=this;return new t(function(t){var i=[e,r,o,u].filter(function(t){return void 0!==t}),a=c.getValue(t);return{type:1===i.length?n.Scalar:n.vector(i.length),content:"("+a.content+")."+i.map(function(t){return"xyzw".charAt(t)}).join("")}})},t.prototype.vec2=function(){var e=this;return new t(function(t){return{type:n.Vector2,content:"vec2("+e.getValue(t).content+")"}})},t.prototype.vec3=function(){var e=this;return new t(function(t){return{type:n.Vector3,content:"vec3("+e.getValue(t).content+")"}})},t.prototype.vec4=function(){var e=this;return new t(function(t){return{type:n.Vector4,content:"vec4("+e.getValue(t).content+")"}})},t.prototype.x=function(){return this.take(0)},t.prototype.y=function(){return this.take(1)},t.prototype.z=function(){return this.take(2)},t.prototype.w=function(){return this.take(3)},t.prototype.r=function(){return this.take(0)},t.prototype.g=function(){return this.take(1)},t.prototype.b=function(){return this.take(2)},t.prototype.a=function(){return this.take(3)},t.prototype.cat=function(e){var r=this;return"number"==typeof e?this.cat(t.val(e)):new t(function(t){var o=r.getValue(t),u=e.getValue(t),c=n.numeric(n.size(o.type)+n.size(u.type));return{type:c,content:c+"("+o.content+", "+u.content+")"}})},t.val=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(1===e.length){if("boolean"==typeof e[0])return new t(function(){return{type:n.Boolean,content:e[0]?"1":"0"}});if(e[0]instanceof t)return e[0];var o=e[0].toString();return new t(function(){return{type:n.Scalar,content:/[e\.]/.test(o)?o:o+".0"}})}if(e.some(function(t){return"number"==typeof t})){var u=e.map(function(n){return t.val(n)});return t.val.apply(null,u)}return e.reduce(function(t,n){return t.cat(n)})},t.PI=t.val(Math.PI),t}();function a(e){var r=e.uniforms,c=e.attributes,a=e.varyings,s=e.instances,l=e.fragment,p=e.vertex,f=u.values("uniform",r),h=u.values("attribute",t(t({},c),s)),y=a?u.values("varying",a):{},g=new o;Object.keys(y).forEach(function(t){y[t].getValue(g)});var v=p(t(t({},f),h)),d=Object.keys(v).map(function(t){return t+" = "+v[t].getValue(g).content+";\n"}).join(""),m=g.getGlobal()+"void main() {\n"+g.getLocal()+d+"}\n",x=new o;Object.keys(y).forEach(function(t){y[t].getValue(g)});var b=l(t(t(t({},f),y),{gl_FragCoord:new i(function(){return{type:n.Vector4,content:"gl_FragCoord"}}),gl_PointCoord:new i(function(){return{type:n.Vector2,content:"gl_FragCoord"}}),gl_FrontFacing:new i(function(){return{type:n.Boolean,content:"gl_FrontFacing"}})})).gl_FragColor.getValue(x);return{vertex:m,fragment:x.getGlobal()+"void main() {\n"+x.getLocal()+"gl_FragColor = "+b.content+";\n}\n",uniforms:u.withoutPrecision(r),attributes:u.withoutPrecision(c),instances:u.withoutPrecision(s)}}exports.Glsl=i,function(t){function r(t){return Array.isArray(t)?t[0]:t}function o(t){var e=0;for(var o in t)e+=n.size(r(t[o]));return e}t.getType=r,t.getPrecision=function(t){return Array.isArray(t)?t[1]:e.High},t.withoutPrecision=function(t){return Object.keys(t).reduce(function(n,e){return n[e]=r(t[e]),n},{})},t.values=function(n,e){var r={};return Object.keys(e).forEach(function(o){var u=e[o];r[o]=new i(function(e){return e.once("types_map_value_"+o,function(){e.addGlobal(n+" "+t.getPrecision(u)+" "+t.getType(u)+" "+o+";\n")}),{type:t.getType(u),content:o}})}),r},t.stride=o,t.layout=function(t){var e=o(t);return Object.keys(t).reduce(function(o,u){var c=o.length?o[o.length-1]:null;return o.push({name:u,stride:e,size:n.size(r(t[u])),offset:c?c.offset+c.size:0}),o},[])}}(u=exports.TypeMap||(exports.TypeMap={})),exports.source=a,exports.val=i.val;
},{}],"Qwvg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.command=exports.Command=void 0;var t=require("./dsl"),e=require("./webgl"),r=function(){function r(e,r,s){var i=this;for(var n in this.gl=e,this.primitivesType=r,this.source=s,this.textureInstances=new Map,this.textureIndexes=new Map,this.program=e.program(s.vertex,s.fragment),this.attributes=e.arrayBuffer(),this.instances=e.arrayBuffer(),this.elements=e.elementsBuffer(),this.attributesStride=t.TypeMap.stride(s.attributes),this.attributesLayout=t.TypeMap.layout(s.attributes),this.instancesStride=t.TypeMap.stride(s.instances),this.instancesLayout=t.TypeMap.layout(s.instances),this.attributesLayout.forEach(function(t){i.program.setAttribute(t.name,i.attributes,t.stride,t.offset)}),this.instancesLayout.forEach(function(t){i.program.setAttribute(t.name,i.instances,t.stride,t.offset)}),s.uniforms)t.TypeMap.getType(s.uniforms[n])===t.Type.Sampler&&this.textureIndexes.set(n,this.textureIndexes.size)}return r.prototype.prepareData=function(t,e,r){var s=new Float32Array(t*r.length);return r.forEach(function(r,i){e.forEach(function(e){var n=r[e.name],a=t*i+e.offset;if(Array.isArray(n))for(var o=0;o<n.length;o++)s[a+o]=n[o];else if(1===e.size&&"number"==typeof n)s[a]=n;else if(2===e.size){var u=n,p=u.x,f=u.y;s[a]=p,s[a+1]=f}else{if(3!==e.size)throw new Error("Unsupported attribute '"+e.name+"' value: "+JSON.stringify(n));var l=n,c=(p=l.x,f=l.y,l.z);s[a]=p,s[a+1]=f,s[a+2]=c}})}),s},r.prototype.setAttributes=function(t){var e=this.prepareData(this.attributesStride,this.attributesLayout,t);return this.attributes.setContent(e),this},r.prototype.setInstances=function(t){var e=this.prepareData(this.instancesStride,this.instancesLayout,t);return this.instances.setContent(e),this},r.prototype.setElements=function(t){return this.elements.setContent(t),this},r.prototype.setUniforms=function(r){var s=this.source.uniforms;for(var i in r){var n=r[i],a=void 0;if("number"==typeof n)a=[n];else if(Array.isArray(n))a=n;else if(n instanceof e.Texture){var o=this.textureIndexes.get(i);this.textureInstances.set(o,n),a=[o]}else if(s[i]===t.Type.Vector2){var u=n;a=[u.x,u.y]}else{if(s[i]!==t.Type.Vector3)throw new Error("Invalid value for uniform '"+i+"', expected "+s[i]);var p=n;a=[p.x,p.y,p.z]}this.program.setUniform(i,a)}return this},r.prototype.draw=function(t,e,r){var s=this;void 0===t&&(t=this.instancesStride?this.instances.length/this.instancesStride:null),void 0===e&&(e=this.attributesStride?this.attributes.length/this.attributesStride:null),void 0===r&&(r=this.elements.length);var i=this.gl;i.settings().program(this.program).enabledAttributes(Object.keys(this.program.attributes).map(function(t){var e;return null===(e=s.program.attributes[t])||void 0===e?void 0:e.location}).filter(function(t){return null!=t})).instancedAttributes(this.instancesLayout.map(function(t){return t.name}).map(function(t){var e;return null===(e=s.program.attributes[t])||void 0===e?void 0:e.location}).filter(function(t){return null!=t})).textures(Array.from(this.textureInstances.entries()).reduce(function(t,e){var r=e[0],s=e[1];return t[r]=s,t},new Array(16).fill(null))).apply(function(){if(null!==t&&0!==r)i.settings().elementsBuffer(s.elements).apply(function(){i.drawsInstancedElements(s.primitivesType,r,t)});else if(null!==t&&null!==e)i.drawInstancedArrays(s.primitivesType,e,t);else if(0!==r)i.settings().elementsBuffer(s.elements).apply(function(){i.drawsElements(s.primitivesType,r)});else{if(!e)throw new Error("Invalid draw dataset");i.drawArrays(s.primitivesType,e)}})},r.prototype.dispose=function(){this.program.dispose(),this.attributes.dispose(),this.instances.dispose(),this.elements.dispose()},r}();function s(e,s,i){return new r(e,s,t.source(i))}exports.Command=r,exports.command=s;
},{"./dsl":"dldi","./webgl":"Bncl"}],"Vc2a":[function(require,module,exports) {
"use strict";var e;function o(e,o){try{return o(e)}finally{e.dispose()}}function r(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return function(o){var r=[];try{return e.forEach(function(e){r.push(e())}),o.apply(void 0,r)}finally{r.forEach(function(e){return e.dispose()})}}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.uses=exports.use=exports.Disposable=void 0,function(e){e.join=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return{dispose:function(){e.forEach(function(e){return e.dispose()})}}}}(e=exports.Disposable||(exports.Disposable={})),exports.use=o,exports.uses=r;
},{}],"Bncl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Program=exports.ElementsBuffer=exports.ArrayBuffer=exports.RenderBuffer=exports.FrameBuffer=exports.Texture=exports.Settings=exports.Gl=exports.PrimitivesType=exports.BufferTarget=exports.BufferUsage=exports.ErrorCode=exports.texturesCount=exports.ShaderType=exports.TextureFormat=exports.TextureFilter=exports.BlendFunction=exports.DepthFunction=exports.BlendEquation=void 0;var e,t,n,r,i,a,o,u,s,l,h=require("./command"),c=require("./disposable"),f=256,d=1024,p=16384,g=0,y=1,m=2,v=3,x=4,b=5,w=6,A=0,B=1,E=768,S=769,T=770,F=771,q=772,L=773,P=774,C=775,D=776,O=32774,R=32777,V=32777,I=34877,M=32778,G=32779,N=32968,W=32969,U=32970,k=32971,_=32769,z=32770,j=32771,Z=32772,H=32773,Y=34962,J=34963,K=34964,Q=34965,X=35040,$=35044,ee=35048,te=34660,ne=34661,re=34342,ie=1028,ae=1029,oe=1032,ue=2884,se=3042,le=3024,he=2960,ce=2929,fe=3089,de=32823,pe=32926,ge=32928,ye=0,me=1280,ve=1281,xe=1282,be=1285,we=2304,Ae=2305,Be=2849,Ee=33901,Se=33902,Te=2885,Fe=2886,qe=2928,Le=2930,Pe=2931,Ce=2932,De=2961,Oe=2962,Re=2964,Ve=2965,Ie=2966,Me=2967,Ge=2963,Ne=2968,We=34816,Ue=34817,ke=34818,_e=34819,ze=36003,je=36004,Ze=36005,He=2978,Ye=3088,Je=3106,Ke=3107,Qe=3317,Xe=3333,$e=3379,et=3386,tt=3408,nt=3410,rt=3411,it=3412,at=3413,ot=3414,ut=3415,st=10752,lt=32824,ht=32873,ct=32936,ft=32937,dt=32938,pt=32939,gt=34467,yt=4352,mt=4353,vt=4354,xt=33170,bt=5120,wt=5121,At=5122,Bt=5123,Et=5124,St=5125,Tt=5126,Ft=6402,qt=6406,Lt=6407,Pt=6408,Ct=6409,Dt=6410,Ot=32819,Rt=32820,Vt=33635,It=35632,Mt=35633,Gt=34921,Nt=36347,Wt=36348,Ut=35661,kt=35660,_t=34930,zt=36349,jt=35663,Zt=35712,Ht=35714,Yt=35715,Jt=35717,Kt=35718,Qt=35721,Xt=35724,$t=35725,en=512,tn=513,nn=514,rn=515,an=516,on=517,un=518,sn=519,ln=7680,hn=7681,cn=7682,fn=7683,dn=5386,pn=34055,gn=34056,yn=7936,mn=7937,vn=7938,xn=9728,bn=9729,wn=9984,An=9985,Bn=9986,En=9987,Sn=10240,Tn=10241,Fn=10242,qn=10243,Ln=3553,Pn=5890,Cn=34067,Dn=34068,On=34069,Rn=34070,Vn=34071,In=34072,Mn=34073,Gn=34074,Nn=34076,Wn=33984,Un=33985,kn=33986,_n=33987,zn=33988,jn=33989,Zn=33990,Hn=33991,Yn=33992,Jn=33993,Kn=33994,Qn=33995,Xn=33996,$n=33997,er=33998,tr=33999,nr=34e3,rr=34001,ir=34002,ar=34003,or=34004,ur=34005,sr=34006,lr=34007,hr=34008,cr=34009,fr=34010,dr=34011,pr=34012,gr=34013,yr=34014,mr=34015,vr=34016,xr=10497,br=33071,wr=33648,Ar=35664,Br=35665,Er=35666,Sr=35667,Tr=35668,Fr=35669,qr=35670,Lr=35671,Pr=35672,Cr=35673,Dr=35674,Or=35675,Rr=35676,Vr=35678,Ir=35680,Mr=34338,Gr=34339,Nr=34340,Wr=34341,Ur=34922,kr=34373,_r=34975,zr=35738,jr=35739,Zr=35713,Hr=36336,Yr=36337,Jr=36338,Kr=36339,Qr=36340,Xr=36341,$r=36160,ei=36161,ti=32854,ni=32855,ri=36194,ii=33189,ai=36168,oi=34041,ui=36162,si=36163,li=36164,hi=36176,ci=36177,fi=36178,di=36179,pi=36180,gi=36181,yi=36048,mi=36049,vi=36050,xi=36051,bi=36064,wi=36096,Ai=36128,Bi=33306,Ei=0,Si=36053,Ti=36054,Fi=36055,qi=36057,Li=36061,Pi=36006,Ci=36007,Di=34024,Oi=1286,Ri=37440,Vi=37441,Ii=37442,Mi=37443,Gi=37444;!function(e){e[e.Add=O]="Add",e[e.Sub=M]="Sub",e[e.RSub=G]="RSub"}(e=exports.BlendEquation||(exports.BlendEquation={})),function(e){e[e.Never=en]="Never",e[e.Less=tn]="Less",e[e.Equal=nn]="Equal",e[e.LWqual=rn]="LWqual",e[e.Greater=an]="Greater",e[e.NotEqual=on]="NotEqual",e[e.GEqual=un]="GEqual",e[e.Always=sn]="Always"}(t=exports.DepthFunction||(exports.DepthFunction={})),function(e){e[e.Zero=A]="Zero",e[e.One=B]="One",e[e.SrcColor=E]="SrcColor",e[e.OneMinusSrcColor=S]="OneMinusSrcColor",e[e.DstColor=P]="DstColor",e[e.OneMinusDstColor=C]="OneMinusDstColor",e[e.SrcAlpha=T]="SrcAlpha",e[e.OneMinusSrcAlpha=F]="OneMinusSrcAlpha",e[e.DstAlpha=q]="DstAlpha",e[e.OneMinusDstAlpha=L]="OneMinusDstAlpha",e[e.SrcAlphaSaturate=D]="SrcAlphaSaturate"}(n=exports.BlendFunction||(exports.BlendFunction={})),function(e){e[e.Nearest=xn]="Nearest",e[e.Linear=bn]="Linear"}(r=exports.TextureFilter||(exports.TextureFilter={})),function(e){e[e.Alpha=qt]="Alpha",e[e.Luminance=Ct]="Luminance",e[e.LuminanceAlpha=Dt]="LuminanceAlpha",e[e.Rgb=Lt]="Rgb",e[e.Rgba=Pt]="Rgba"}(i=exports.TextureFormat||(exports.TextureFormat={})),function(e){e[e.Vertex=Mt]="Vertex",e[e.Fragment=It]="Fragment"}(a=exports.ShaderType||(exports.ShaderType={})),exports.texturesCount=16,function(e){e[e.NoError=ye]="NoError",e[e.InvalidEnum=me]="InvalidEnum",e[e.InvalidValue=ve]="InvalidValue",e[e.InvalidOperation=xe]="InvalidOperation",e[e.OutOfMemory=be]="OutOfMemory"}(o=exports.ErrorCode||(exports.ErrorCode={})),function(e){e[e.Stream=X]="Stream",e[e.Static=$]="Static",e[e.Dynamic=ee]="Dynamic"}(u=exports.BufferUsage||(exports.BufferUsage={})),function(e){e[e.Array=Y]="Array",e[e.Elements=J]="Elements"}(s=exports.BufferTarget||(exports.BufferTarget={})),function(e){e[e.Points=g]="Points",e[e.Lines=y]="Lines",e[e.LineStrip=v]="LineStrip",e[e.LineLoop=m]="LineLoop",e[e.Triangles=x]="Triangles",e[e.TriangleStrip=b]="TriangleStrip",e[e.TriangleFan=w]="TriangleFan"}(l=exports.PrimitivesType||(exports.PrimitivesType={}));var Ni,Wi=function(){function e(e,t){void 0===t&&(t={}),this.settingsCache=Ni.initial(),this.handle=e.getContext("webgl",t),this.instancedArrays=this.handle.getExtension("ANGLE_instanced_arrays")}return e.prototype.isContextLost=function(){return this.handle.isContextLost()},e.prototype.getPointSizeRange=function(){return this.handle.getParameter(Ee)},e.prototype.cleanColorBuffer=function(){return this.handle.clear(p),this},e.prototype.cleanDepthBuffer=function(){return this.handle.clear(f),this},e.prototype.cleanBuffers=function(){return this.handle.clear(p|f),this},e.prototype.drawArrays=function(e,t){return this.handle.drawArrays(e,0,t),this},e.prototype.drawsElements=function(e,t){return this.handle.drawElements(e,t,Bt,0),this},e.prototype.drawInstancedArrays=function(e,t,n){return this.instancedArrays.drawArraysInstancedANGLE(e,0,t,n),this},e.prototype.drawsInstancedElements=function(e,t,n){return this.instancedArrays.drawElementsInstancedANGLE(e,t,Bt,0,n),this},e.prototype.settings=function(){return new Ui(this,this.settingsCache)},e.prototype.texture=function(e){return new ki(this,e)},e.prototype.arrayBuffer=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=u.Dynamic),new ji(this,e,t)},e.prototype.elementsBuffer=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=u.Dynamic),new Zi(this,e,t)},e.prototype.program=function(e,t){var n=this;return c.uses(function(){return new Hi(n,a.Vertex,e)},function(){return new Hi(n,a.Fragment,t)})(function(e,t){return new Yi(n,e,t)})},e.prototype.command=function(e,t){return h.command(this,e,t)},e.prototype.dispose=function(){var e=this.handle.getExtension("WEBGL_lose_context");e&&e.loseContext()},e}();exports.Gl=Wi,function(r){r.initial=function(){return{blend:!1,viewport:[0,0,0,0],scissorTest:!1,scissorBox:[0,0,0,0],depthTest:!1,depthFunction:t.Less,clearDepth:1,lineWidth:1,blendEquation:[e.Add,e.Add],blendFunction:[n.One,n.Zero,n.One,n.Zero],clearColor:[0,0,0,0],activeTexture:0,textures:new Map,arrayBuffer:null,elementsBuffer:null,program:null,enabledAttributes:new Set,instancedAttributes:new Set,renderBuffer:null,frameBuffer:null}}}(Ni||(Ni={}));var Ui=function(){function e(t,n,r){var i,a;void 0===r&&(r=function(e){return e()}),this.gl=t,this.cache=n,this.apply=r,this.blend=e.cached({read:function(e){return e.blend},write:function(e,t){e.blend=t},equals:function(e,t){return e===t},apply:function(e,t){t?e.handle.enable(se):e.handle.disable(se)}}),this.viewport=(i=e.cached({read:function(e){return e.viewport},write:function(e,t){e.viewport=t},equals:function(e,t){return e.every(function(e,n){return e===t[n]})},apply:function(e,t){var n=t[0],r=t[1],i=t[2],a=t[3];e.handle.viewport(n,r,i,a)}}),function(e,t,n,r){return i.call(this,[e,t,n,r])}),this.scissorTest=e.cached({read:function(e){return e.scissorTest},write:function(e,t){e.scissorTest=t},equals:function(e,t){return e===t},apply:function(e,t){t?e.handle.enable(fe):e.handle.disable(fe)}}),this.scissorBox=function(){var t=e.cached({read:function(e){return e.scissorBox},write:function(e,t){e.scissorBox=t},equals:function(e,t){return e.every(function(e,n){return e===t[n]})},apply:function(e,t){var n=t[0],r=t[1],i=t[2],a=t[3];e.handle.scissor(n,r,i,a)}});return function(e,n,r,i){return t.call(this,[e,n,r,i])}}(),this.depthTest=e.cached({read:function(e){return e.depthTest},write:function(e,t){e.depthTest=t},equals:function(e,t){return e===t},apply:function(e,t){t?e.handle.enable(ce):e.handle.disable(ce)}}),this.clearDepth=e.cached({read:function(e){return e.clearDepth},write:function(e,t){e.clearDepth=t},equals:function(e,t){return e===t},apply:function(e,t){e.handle.clearDepth(t)}}),this.lineWidth=e.cached({read:function(e){return e.lineWidth},write:function(e,t){e.lineWidth=t},equals:function(e,t){return e===t},apply:function(e,t){e.handle.lineWidth(t)}}),this.blendEquation=function(){var t=e.cached({read:function(e){return e.blendEquation},write:function(e,t){e.blendEquation=t},equals:function(e,t){return e.every(function(e,n){return e===t[n]})},apply:function(e,t){var n=t[0],r=t[1];e.handle.blendEquationSeparate(n,r)}});return function(e,n){return void 0===n&&(n=e),t.call(this,[e,n])}}(),this.blendFunction=function(){var t=e.cached({read:function(e){return e.blendFunction},write:function(e,t){e.blendFunction=t},equals:function(e,t){return e.every(function(e,n){return e===t[n]})},apply:function(e,t){var n=t[0],r=t[1],i=t[2],a=t[3];e.handle.blendFuncSeparate(n,r,i,a)}});return function(e,n,r,i){return void 0===r&&(r=e),void 0===i&&(i=n),t.call(this,[e,n,r,i])}}(),this.depthFunction=e.cached({read:function(e){return e.depthFunction},write:function(e,t){e.depthFunction=t},equals:function(e,t){return e===t},apply:function(e,t){e.handle.depthFunc(t)}}),this.clearColor=function(){var t=e.cached({read:function(e){return e.clearColor},write:function(e,t){e.clearColor=t},equals:function(e,t){return e.every(function(e,n){return e===t[n]})},apply:function(e,t){var n=t[0],r=t[1],i=t[2],a=t[3];e.handle.clearColor(n,r,i,a)}});return function(e,n,r,i){return t.call(this,[e,n,r,i])}}(),this.activeTexture=e.cached({read:function(e){return e.activeTexture},write:function(e,t){e.activeTexture=t},equals:function(e,t){return e===t},apply:function(e,t){e.handle.activeTexture(Wn+t)}}),this.texture=(a=new Array(16).fill(null).map(function(t,n){return e.cached({read:function(e){return e.textures.get(n)||null},write:function(e,t){t?e.textures.set(n,t):e.textures.delete(n)},equals:function(e,t){return e===t},apply:function(e,t){e.settings().activeTexture(n).apply(function(){e.handle.bindTexture(Ln,(null==t?void 0:t.handle)||null)})}})}),function(e,t){return a[e].call(this,t)}),this.arrayBuffer=e.cached({read:function(e){return e.arrayBuffer},write:function(e,t){e.arrayBuffer=t},equals:function(e,t){return e===t},apply:function(e,t){var n;e.handle.bindBuffer(Y,null!==(n=null==t?void 0:t.handle)&&void 0!==n?n:null)}}),this.elementsBuffer=e.cached({read:function(e){return e.elementsBuffer},write:function(e,t){e.elementsBuffer=t},equals:function(e,t){return e===t},apply:function(e,t){var n;e.handle.bindBuffer(J,null!==(n=null==t?void 0:t.handle)&&void 0!==n?n:null)}}),this.program=e.cached({read:function(e){return e.program},write:function(e,t){e.program=t},equals:function(e,t){return e===t},apply:function(e,t){e.handle.useProgram(t?t.handle:null)}}),this.renderBuffer=e.cached({read:function(e){return e.renderBuffer},write:function(e,t){e.renderBuffer=t},equals:function(e,t){return e===t},apply:function(e,t){e.handle.bindRenderbuffer(ei,t?t.handle:null)}}),this.frameBuffer=e.cached({read:function(e){return e.frameBuffer},write:function(e,t){e.frameBuffer=t},equals:function(e,t){return e===t},apply:function(e,t){e.handle.bindFramebuffer($r,t?t.handle:null)}})}return e.cached=function(t){var n=t.read,r=t.write,i=t.equals,a=t.apply;return function(t){var o=this;return this.then(new e(this.gl,this.cache,function(e){var u=n(o.cache);if(i(u,t))return e();try{return r(o.cache,t),a(o.gl,t),e()}finally{r(o.cache,u),a(o.gl,u)}}))}},e.prototype.then=function(t){var n=this;return new e(this.gl,this.cache,function(e){return n.apply(function(){return t.apply(e)})})},e.prototype.textures=function(e){for(var t=this,n=0;n<16;n++)t=t.texture(n,n>=e.length?null:e[n]);return t},e.prototype.enabledAttributes=function(t){var n=this;return this.then(new e(this.gl,this.cache,function(e){var r=n.gl.handle,i=n.cache.enabledAttributes,a=new Set(t);n.cache.enabledAttributes=a;var o=function(e,t){e.forEach(function(e){t.has(e)||r.disableVertexAttribArray(e)}),t.forEach(function(t){e.has(t)||r.enableVertexAttribArray(t)})};try{return o(i,a),e()}finally{o(a,i),n.cache.enabledAttributes=i}}))},e.prototype.instancedAttributes=function(t){var n=this;return this.then(new e(this.gl,this.cache,function(e){var r=n.gl.instancedArrays,i=n.cache.instancedAttributes,a=new Set(t);n.cache.instancedAttributes=a;var o=function(e,t){e.forEach(function(e){t.has(e)||r.vertexAttribDivisorANGLE(e,0)}),t.forEach(function(t){e.has(t)||r.vertexAttribDivisorANGLE(t,1)})};try{return o(i,a),e()}finally{o(a,i),n.cache.instancedAttributes=i}}))},e.prototype.renderTarget=function(t){var n=this;return new e(this.gl,this.cache,function(e){return c.use(new _i(n.gl,t),function(r){return n.gl.settings().frameBuffer(r).viewport(0,0,t.width,t.height).apply(e)})})},e}();exports.Settings=Ui;var ki=function(){function e(e,t){var n=this;this.gl=e,this.handle=e.handle.createTexture(),this.format=t.format||i.Rgba,this.filter=t.filter||r.Nearest,"image"in t?(this.width=t.image instanceof HTMLImageElement?t.image.naturalWidth:t.image.width,this.height=t.image instanceof HTMLImageElement?t.image.naturalHeight:t.image.height):(this.width=t.width,this.height=t.height),e.settings().activeTexture(0).texture(0,this).apply(function(){e.handle.pixelStorei(Ri,1),e.handle.texParameteri(Ln,Sn,n.filter),e.handle.texParameteri(Ln,Tn,n.filter),e.handle.texParameteri(Ln,Fn,br),e.handle.texParameteri(Ln,qn,br),"image"in t?e.handle.texImage2D(Ln,0,n.format,n.format,wt,t.image):e.handle.texImage2D(Ln,0,n.format,n.width,n.height,0,n.format,wt,"data"in t?t.data:null)})}return e.prototype.dispose=function(){this.gl.handle.deleteTexture(this.handle)},e}();exports.Texture=ki;var _i=function(){function e(e,t,n){this.gl=e,this.colorBuffer=t,this.depthBuffer=n,this.handle=e.handle.createFramebuffer(),e.settings().frameBuffer(this).apply(function(){e.handle.framebufferTexture2D($r,bi,Ln,t.handle,0),n&&e.handle.framebufferRenderbuffer($r,wi,ei,n.handle)})}return e.prototype.dispose=function(){this.gl.handle.deleteFramebuffer(this.handle)},e}();exports.FrameBuffer=_i;var zi=function(){function e(e,t,n){this.gl=e,this.widthValue=t,this.heightValue=n,this.handle=e.handle.createRenderbuffer(),e.settings().renderBuffer(this).apply(function(){e.handle.renderbufferStorage(ei,ii,t,n)})}return Object.defineProperty(e.prototype,"width",{get:function(){return this.widthValue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.heightValue},enumerable:!1,configurable:!0}),e.prototype.resize=function(e,t){var n=this.gl;return e===this.width&&t===this.height||(this.widthValue=e,this.heightValue=t,n.settings().renderBuffer(this).apply(function(){n.handle.renderbufferStorage(ei,ii,e,t)})),this},e.prototype.dispose=function(){this.gl.handle.deleteRenderbuffer(this.handle)},e}();exports.RenderBuffer=zi;var ji=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=u.Dynamic),this.gl=e,this.usage=n,this.lengthValue=0,this.handle=e.handle.createBuffer(),t&&this.setContent(t)}return Object.defineProperty(e.prototype,"length",{get:function(){return this.lengthValue},enumerable:!1,configurable:!0}),e.prototype.setContent=function(e){var t=this,n=e instanceof Float32Array?e:new Float32Array(e);this.lengthValue=n.length;var r=this.gl;return r.settings().arrayBuffer(this).apply(function(){r.handle.bufferData(WebGL2RenderingContext.ARRAY_BUFFER,n,t.usage)}),this},e.prototype.dispose=function(){this.gl.handle.deleteBuffer(this.handle)},e}();exports.ArrayBuffer=ji;var Zi=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=u.Dynamic),this.gl=e,this.usage=n,this.lengthValue=0,this.handle=e.handle.createBuffer(),t&&this.setContent(t)}return Object.defineProperty(e.prototype,"length",{get:function(){return this.lengthValue},enumerable:!1,configurable:!0}),e.prototype.setContent=function(e){var t=this,n=e instanceof Uint8Array||e instanceof Uint16Array?e:new Uint16Array(e);this.lengthValue=n.length;var r=this.gl;return r.settings().elementsBuffer(this).apply(function(){r.handle.bufferData(WebGL2RenderingContext.ARRAY_BUFFER,n,t.usage)}),this},e.prototype.dispose=function(){this.gl.handle.deleteBuffer(this.handle)},e}();exports.ElementsBuffer=Zi;var Hi=function(){function e(e,t,n){this.gl=e,this.type=t,this.source=n;var r=this.handle=e.handle.createShader(t);if(e.handle.shaderSource(r,n),e.handle.compileShader(r),!1===e.handle.getShaderParameter(r,Zr))throw new Error("WebGL error '"+e.handle.getShaderInfoLog(r)+"' in '"+n+"'")}return e.prototype.dispose=function(){this.gl.handle.deleteShader(this.handle)},e}(),Yi=function(){function e(e,t,n){this.gl=e,this.vertex=t,this.fragment=n,this.uniforms={},this.attributes={};var r=this.handle=e.handle.createProgram();if(e.handle.attachShader(r,t.handle),e.handle.attachShader(r,n.handle),e.handle.linkProgram(r),e.handle.validateProgram(r),!1===e.handle.getProgramParameter(r,Ht))throw new Error(e.handle.getProgramInfoLog(r)||"Program linking error:\n"+t.source+";\n"+n.source);for(var i=e.handle.getProgramParameter(r,Kt),a=0;a<i;a++){null!==(u=e.handle.getActiveUniform(r,a))&&(this.uniforms[u.name]={type:u.type,location:e.handle.getUniformLocation(r,u.name),size:u.size})}var o=e.handle.getProgramParameter(r,Qt);for(a=0;a<o;a++){var u;null!=(u=e.handle.getActiveAttrib(r,a))&&(this.attributes[u.name]={type:u.type,location:a,size:u.size})}}return e.prototype.setUniform=function(e,t){var n=this.gl,r=this.uniforms[e];if(r){var i=r.location,a=r.type;n.settings().program(this).apply(function(){switch(a){case qr:n.handle.uniform1i(i,t[0]?1:0);break;case Vr:n.handle.uniform1iv(i,t);break;case Tt:n.handle.uniform1fv(i,t);break;case Ar:n.handle.uniform2fv(i,t);break;case Br:n.handle.uniform3fv(i,t);break;case Er:n.handle.uniform4fv(i,t);break;case Dr:n.handle.uniformMatrix2fv(i,!1,t);break;case Or:n.handle.uniformMatrix3fv(i,!1,t);break;case Rr:n.handle.uniformMatrix4fv(i,!1,t)}})}},e.prototype.setAttribute=function(e,t,n,r){var i=this.attributes[e];if(null!=i){var a=this.gl;a.settings().arrayBuffer(t).apply(function(){a.handle.vertexAttribPointer(i.location,function(){switch(i.type){case Tt:return 1;case Ar:return 2;case Br:return 3;case Er:case Dr:return 4;case Or:return 9;case Rr:return 16;default:throw new Error("Invalid attribute type '"+i.type+"'")}}(),Tt,!1,4*n,4*r)})}else console.warn("Attribute '"+e+"' not found")},e.prototype.dispose=function(){this.gl.handle.deleteProgram(this.handle)},e}();exports.Program=Yi;
},{"./command":"Qwvg","./disposable":"Vc2a"}],"fUdq":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,t,i){void 0===i&&(i=t),Object.defineProperty(e,i,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,i){void 0===i&&(i=t),e[i]=r[t]}),r=this&&this.__exportStar||function(r,t){for(var i in r)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||e(t,r,i)};Object.defineProperty(exports,"__esModule",{value:!0}),r(require("./webgl"),exports),r(require("./dsl"),exports),r(require("./command"),exports),r(require("./disposable"),exports);
},{"./webgl":"Bncl","./dsl":"dldi","./command":"Qwvg","./disposable":"Vc2a"}],"Dk69":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../src");function a(e){requestAnimationFrame(function(){e(),a(e)})}function t(){for(var e=Math.random(),a=Math.random();0===a;)a=Math.random();return Math.sqrt(-2*Math.log(a))*Math.cos(2*Math.PI*e)}document.addEventListener("DOMContentLoaded",function(){var n,r=document.getElementById("canvas"),i=r.width=r.clientWidth*devicePixelRatio,o=r.height=r.clientHeight*devicePixelRatio,l=new e.Gl(r,{preserveDrawingBuffer:!0}),u=l.command(e.PrimitivesType.Points,{uniforms:{uTime:e.Type.Scalar,uSource:e.Type.Vector2,uTarget:e.Type.Vector2},instances:{iOffset:e.Type.Vector2,iAmplitude:e.Type.Scalar,iColor:e.Type.Vector4,iPhase:e.Type.Scalar,iScale:e.Type.Scalar,iSpeed:e.Type.Scalar},attributes:{aPeriod:e.Type.Scalar,aPhase:e.Type.Scalar},varyings:{vColor:e.Type.Vector4},vertex:function(a){var t=a.uTime,n=a.uSource,r=a.uTarget,i=a.iOffset,o=a.aPhase,l=a.iAmplitude,u=a.aPeriod,d=a.iPhase,c=a.iColor,m=a.iScale,s=a.iSpeed,h=t.div(u.mul(m)).add(o).memMQ(),f=r.sub(n).take(1,0).mul(e.val(-1,1)).normalize().memMQ(),p=h.add(d).add(o).mul(2*Math.PI).sin().mul(f).mul(l).mul(f).add(i).memMQ(),v=n.mix(r,h.mul(s).mod(1).vec2()).add(p).cat(e.val(0,1)).memHQ();return{gl_Position:v.add(e.val(0,v.x().add(1).mul(Math.PI).sin().mul(.25),0,0)),gl_PointSize:e.val(1),vColor:c}},fragment:function(e){return{gl_FragColor:e.vColor}}}).setUniforms({uSource:[-1.1,0],uTarget:[1.1,0]}).setAttributes(new Array(500).fill(null).map(function(){return{aPeriod:3e3+500*Math.random(),aPhase:Math.random()}})).setInstances(new Array(500).fill(null).map(function(e,a){return{iAmplitude:.1*Math.random(),iOffset:[.05*Math.random(),.1*t()],iColor:[.9*(a%3==0?1:0),.9*(a%3==1?1:0),.9*(a%3==2?1:0),.15*Math.random()+.45],iPhase:Math.random(),iScale:.2*Math.random()+.9,iSpeed:.2*Math.random()+.9}})),d=(n=Date.now()-3e3,function(){return Date.now()-n});a(function(){l.settings().viewport(0,0,i,o).clearColor(0,0,0,1).blend(!0).blendFunction(e.BlendFunction.SrcAlpha,e.BlendFunction.One,e.BlendFunction.OneMinusSrcAlpha,e.BlendFunction.One).apply(function(){l.cleanColorBuffer(),u.setUniforms({uTime:d()}).draw()})})});
},{"../src":"fUdq"}]},{},["Dk69"], null)