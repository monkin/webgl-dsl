parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"pRwy":[function(require,module,exports) {
"use strict";var e;function o(e,o){try{return o(e)}finally{e.dispose()}}function r(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return function(o){var r=[];try{return e.forEach(function(e){r.push(e())}),o.apply(void 0,r)}finally{r.forEach(function(e){return e.dispose()})}}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.uses=exports.use=exports.Disposable=void 0,function(e){e.join=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return{dispose:function(){e.forEach(function(e){return e.dispose()})}}}}(e=exports.Disposable||(exports.Disposable={})),exports.use=o,exports.uses=r;
},{}],"ZRYf":[function(require,module,exports) {
"use strict";var E;Object.defineProperty(exports,"__esModule",{value:!0}),exports.GlEnum=void 0,function(E){E.DEPTH_BUFFER_BIT=256,E.STENCIL_BUFFER_BIT=1024,E.COLOR_BUFFER_BIT=16384,E.POINTS=0,E.LINES=1,E.LINE_LOOP=2,E.LINE_STRIP=3,E.TRIANGLES=4,E.TRIANGLE_STRIP=5,E.TRIANGLE_FAN=6,E.ZERO=0,E.ONE=1,E.SRC_COLOR=768,E.ONE_MINUS_SRC_COLOR=769,E.SRC_ALPHA=770,E.ONE_MINUS_SRC_ALPHA=771,E.DST_ALPHA=772,E.ONE_MINUS_DST_ALPHA=773,E.DST_COLOR=774,E.ONE_MINUS_DST_COLOR=775,E.SRC_ALPHA_SATURATE=776,E.FUNC_ADD=32774,E.BLEND_EQUATION=32777,E.BLEND_EQUATION_RGB=32777,E.BLEND_EQUATION_ALPHA=34877,E.FUNC_SUBTRACT=32778,E.FUNC_REVERSE_SUBTRACT=32779,E.BLEND_DST_RGB=32968,E.BLEND_SRC_RGB=32969,E.BLEND_DST_ALPHA=32970,E.BLEND_SRC_ALPHA=32971,E.CONSTANT_COLOR=32769,E.ONE_MINUS_CONSTANT_COLOR=32770,E.CONSTANT_ALPHA=32771,E.ONE_MINUS_CONSTANT_ALPHA=32772,E.BLEND_COLOR=32773,E.ARRAY_BUFFER=34962,E.ELEMENT_ARRAY_BUFFER=34963,E.ARRAY_BUFFER_BINDING=34964,E.ELEMENT_ARRAY_BUFFER_BINDING=34965,E.STREAM_DRAW=35040,E.STATIC_DRAW=35044,E.DYNAMIC_DRAW=35048,E.BUFFER_SIZE=34660,E.BUFFER_USAGE=34661,E.CURRENT_VERTEX_ATTRIB=34342,E.FRONT=1028,E.BACK=1029,E.FRONT_AND_BACK=1032,E.CULL_FACE=2884,E.BLEND=3042,E.DITHER=3024,E.STENCIL_TEST=2960,E.DEPTH_TEST=2929,E.SCISSOR_TEST=3089,E.POLYGON_OFFSET_FILL=32823,E.SAMPLE_ALPHA_TO_COVERAGE=32926,E.SAMPLE_COVERAGE=32928,E.NO_ERROR=0,E.INVALID_ENUM=1280,E.INVALID_VALUE=1281,E.INVALID_OPERATION=1282,E.OUT_OF_MEMORY=1285,E.CW=2304,E.CCW=2305,E.LINE_WIDTH=2849,E.ALIASED_POINT_SIZE_RANGE=33901,E.ALIASED_LINE_WIDTH_RANGE=33902,E.CULL_FACE_MODE=2885,E.FRONT_FACE=2886,E.DEPTH_RANGE=2928,E.DEPTH_WRITEMASK=2930,E.DEPTH_CLEAR_VALUE=2931,E.DEPTH_FUNC=2932,E.STENCIL_CLEAR_VALUE=2961,E.STENCIL_FUNC=2962,E.STENCIL_FAIL=2964,E.STENCIL_PASS_DEPTH_FAIL=2965,E.STENCIL_PASS_DEPTH_PASS=2966,E.STENCIL_REF=2967,E.STENCIL_VALUE_MASK=2963,E.STENCIL_WRITEMASK=2968,E.STENCIL_BACK_FUNC=34816,E.STENCIL_BACK_FAIL=34817,E.STENCIL_BACK_PASS_DEPTH_FAIL=34818,E.STENCIL_BACK_PASS_DEPTH_PASS=34819,E.STENCIL_BACK_REF=36003,E.STENCIL_BACK_VALUE_MASK=36004,E.STENCIL_BACK_WRITEMASK=36005,E.VIEWPORT=2978,E.SCISSOR_BOX=3088,E.COLOR_CLEAR_VALUE=3106,E.COLOR_WRITEMASK=3107,E.UNPACK_ALIGNMENT=3317,E.PACK_ALIGNMENT=3333,E.MAX_TEXTURE_SIZE=3379,E.MAX_VIEWPORT_DIMS=3386,E.SUBPIXEL_BITS=3408,E.RED_BITS=3410,E.GREEN_BITS=3411,E.BLUE_BITS=3412,E.ALPHA_BITS=3413,E.DEPTH_BITS=3414,E.STENCIL_BITS=3415,E.POLYGON_OFFSET_UNITS=10752,E.POLYGON_OFFSET_FACTOR=32824,E.TEXTURE_BINDING_2D=32873,E.SAMPLE_BUFFERS=32936,E.SAMPLES=32937,E.SAMPLE_COVERAGE_VALUE=32938,E.SAMPLE_COVERAGE_INVERT=32939,E.COMPRESSED_TEXTURE_FORMATS=34467,E.DONT_CARE=4352,E.FASTEST=4353,E.NICEST=4354,E.GENERATE_MIPMAP_HINT=33170,E.BYTE=5120,E.UNSIGNED_BYTE=5121,E.SHORT=5122,E.UNSIGNED_SHORT=5123,E.INT=5124,E.UNSIGNED_INT=5125,E.FLOAT=5126,E.DEPTH_COMPONENT=6402,E.ALPHA=6406,E.RGB=6407,E.RGBA=6408,E.LUMINANCE=6409,E.LUMINANCE_ALPHA=6410,E.UNSIGNED_SHORT_4_4_4_4=32819,E.UNSIGNED_SHORT_5_5_5_1=32820,E.UNSIGNED_SHORT_5_6_5=33635,E.FRAGMENT_SHADER=35632,E.VERTEX_SHADER=35633,E.MAX_VERTEX_ATTRIBS=34921,E.MAX_VERTEX_UNIFORM_VECTORS=36347,E.MAX_VARYING_VECTORS=36348,E.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,E.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,E.MAX_TEXTURE_IMAGE_UNITS=34930,E.MAX_FRAGMENT_UNIFORM_VECTORS=36349,E.SHADER_TYPE=35663,E.DELETE_STATUS=35712,E.LINK_STATUS=35714,E.VALIDATE_STATUS=35715,E.ATTACHED_SHADERS=35717,E.ACTIVE_UNIFORMS=35718,E.ACTIVE_ATTRIBUTES=35721,E.SHADING_LANGUAGE_VERSION=35724,E.CURRENT_PROGRAM=35725,E.NEVER=512,E.LESS=513,E.EQUAL=514,E.LEQUAL=515,E.GREATER=516,E.NOTEQUAL=517,E.GEQUAL=518,E.ALWAYS=519,E.KEEP=7680,E.REPLACE=7681,E.INCR=7682,E.DECR=7683,E.INVERT=5386,E.INCR_WRAP=34055,E.DECR_WRAP=34056,E.VENDOR=7936,E.RENDERER=7937,E.VERSION=7938,E.NEAREST=9728,E.LINEAR=9729,E.NEAREST_MIPMAP_NEAREST=9984,E.LINEAR_MIPMAP_NEAREST=9985,E.NEAREST_MIPMAP_LINEAR=9986,E.LINEAR_MIPMAP_LINEAR=9987,E.TEXTURE_MAG_FILTER=10240,E.TEXTURE_MIN_FILTER=10241,E.TEXTURE_WRAP_S=10242,E.TEXTURE_WRAP_T=10243,E.TEXTURE_2D=3553,E.TEXTURE=5890,E.TEXTURE_CUBE_MAP=34067,E.TEXTURE_BINDING_CUBE_MAP=34068,E.TEXTURE_CUBE_MAP_POSITIVE_X=34069,E.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,E.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,E.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,E.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,E.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,E.MAX_CUBE_MAP_TEXTURE_SIZE=34076,E.TEXTURE0=33984,E.TEXTURE1=33985,E.TEXTURE2=33986,E.TEXTURE3=33987,E.TEXTURE4=33988,E.TEXTURE5=33989,E.TEXTURE6=33990,E.TEXTURE7=33991,E.TEXTURE8=33992,E.TEXTURE9=33993,E.TEXTURE10=33994,E.TEXTURE11=33995,E.TEXTURE12=33996,E.TEXTURE13=33997,E.TEXTURE14=33998,E.TEXTURE15=33999,E.TEXTURE16=34e3,E.TEXTURE17=34001,E.TEXTURE18=34002,E.TEXTURE19=34003,E.TEXTURE20=34004,E.TEXTURE21=34005,E.TEXTURE22=34006,E.TEXTURE23=34007,E.TEXTURE24=34008,E.TEXTURE25=34009,E.TEXTURE26=34010,E.TEXTURE27=34011,E.TEXTURE28=34012,E.TEXTURE29=34013,E.TEXTURE30=34014,E.TEXTURE31=34015,E.ACTIVE_TEXTURE=34016,E.REPEAT=10497,E.CLAMP_TO_EDGE=33071,E.MIRRORED_REPEAT=33648,E.FLOAT_VEC2=35664,E.FLOAT_VEC3=35665,E.FLOAT_VEC4=35666,E.INT_VEC2=35667,E.INT_VEC3=35668,E.INT_VEC4=35669,E.BOOL=35670,E.BOOL_VEC2=35671,E.BOOL_VEC3=35672,E.BOOL_VEC4=35673,E.FLOAT_MAT2=35674,E.FLOAT_MAT3=35675,E.FLOAT_MAT4=35676,E.SAMPLER_2D=35678,E.SAMPLER_CUBE=35680,E.VERTEX_ATTRIB_ARRAY_ENABLED=34338,E.VERTEX_ATTRIB_ARRAY_SIZE=34339,E.VERTEX_ATTRIB_ARRAY_STRIDE=34340,E.VERTEX_ATTRIB_ARRAY_TYPE=34341,E.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,E.VERTEX_ATTRIB_ARRAY_POINTER=34373,E.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,E.IMPLEMENTATION_COLOR_READ_TYPE=35738,E.IMPLEMENTATION_COLOR_READ_FORMAT=35739,E.COMPILE_STATUS=35713,E.LOW_FLOAT=36336,E.MEDIUM_FLOAT=36337,E.HIGH_FLOAT=36338,E.LOW_INT=36339,E.MEDIUM_INT=36340,E.HIGH_INT=36341,E.FRAMEBUFFER=36160,E.RENDERBUFFER=36161,E.RGBA4=32854,E.RGB5_A1=32855,E.RGB565=36194,E.DEPTH_COMPONENT16=33189,E.STENCIL_INDEX8=36168,E.DEPTH_STENCIL=34041,E.RENDERBUFFER_WIDTH=36162,E.RENDERBUFFER_HEIGHT=36163,E.RENDERBUFFER_INTERNAL_FORMAT=36164,E.RENDERBUFFER_RED_SIZE=36176,E.RENDERBUFFER_GREEN_SIZE=36177,E.RENDERBUFFER_BLUE_SIZE=36178,E.RENDERBUFFER_ALPHA_SIZE=36179,E.RENDERBUFFER_DEPTH_SIZE=36180,E.RENDERBUFFER_STENCIL_SIZE=36181,E.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,E.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,E.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,E.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,E.COLOR_ATTACHMENT0=36064,E.DEPTH_ATTACHMENT=36096,E.STENCIL_ATTACHMENT=36128,E.DEPTH_STENCIL_ATTACHMENT=33306,E.NONE=0,E.FRAMEBUFFER_COMPLETE=36053,E.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,E.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,E.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,E.FRAMEBUFFER_UNSUPPORTED=36061,E.FRAMEBUFFER_BINDING=36006,E.RENDERBUFFER_BINDING=36007,E.MAX_RENDERBUFFER_SIZE=34024,E.INVALID_FRAMEBUFFER_OPERATION=1286,E.UNPACK_FLIP_Y_WEBGL=37440,E.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,E.CONTEXT_LOST_WEBGL=37442,E.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,E.BROWSER_DEFAULT_WEBGL=37444}(E=exports.GlEnum||(exports.GlEnum={}));
},{}],"k6Ze":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Program=exports.ElementsBuffer=exports.ArrayBuffer=exports.RenderBuffer=exports.FrameBuffer=exports.Texture=exports.Settings=exports.Gl=exports.PrimitivesType=exports.BufferTarget=exports.BufferUsage=exports.ErrorCode=exports.texturesCount=exports.ShaderType=exports.TextureFormat=exports.TextureFilter=exports.BlendFunction=exports.DepthFunction=void 0;var e,t,n,r,i,u,a,l,o,s,h=require("./disposable"),c=require("./enums");!function(e){e[e.Add=c.GlEnum.FUNC_ADD]="Add",e[e.Sub=c.GlEnum.FUNC_SUBTRACT]="Sub",e[e.RSub=c.GlEnum.FUNC_REVERSE_SUBTRACT]="RSub"}(e||(e={})),function(e){e[e.Never=c.GlEnum.NEVER]="Never",e[e.Less=c.GlEnum.LESS]="Less",e[e.Equal=c.GlEnum.EQUAL]="Equal",e[e.LWqual=c.GlEnum.LEQUAL]="LWqual",e[e.Greater=c.GlEnum.GREATER]="Greater",e[e.NotEqual=c.GlEnum.NOTEQUAL]="NotEqual",e[e.GEqual=c.GlEnum.GEQUAL]="GEqual",e[e.Always=c.GlEnum.ALWAYS]="Always"}(t=exports.DepthFunction||(exports.DepthFunction={})),function(e){e[e.Zero=c.GlEnum.ZERO]="Zero",e[e.One=c.GlEnum.ONE]="One",e[e.SrcColor=c.GlEnum.SRC_COLOR]="SrcColor",e[e.OneMinusSrcColor=c.GlEnum.ONE_MINUS_SRC_COLOR]="OneMinusSrcColor",e[e.DstColor=c.GlEnum.DST_COLOR]="DstColor",e[e.OneMinusDstColor=c.GlEnum.ONE_MINUS_DST_COLOR]="OneMinusDstColor",e[e.SrcAlpha=c.GlEnum.SRC_ALPHA]="SrcAlpha",e[e.OneMinusSrcAlpha=c.GlEnum.ONE_MINUS_SRC_ALPHA]="OneMinusSrcAlpha",e[e.DstAlpha=c.GlEnum.DST_ALPHA]="DstAlpha",e[e.OneMinusDstAlpha=c.GlEnum.ONE_MINUS_DST_ALPHA]="OneMinusDstAlpha",e[e.SrcAlphaSaturate=c.GlEnum.SRC_ALPHA_SATURATE]="SrcAlphaSaturate"}(n=exports.BlendFunction||(exports.BlendFunction={})),function(e){e[e.Nearest=c.GlEnum.NEAREST]="Nearest",e[e.Linear=c.GlEnum.LINEAR]="Linear"}(r=exports.TextureFilter||(exports.TextureFilter={})),function(e){e[e.Alpha=c.GlEnum.ALPHA]="Alpha",e[e.Luminance=c.GlEnum.LUMINANCE]="Luminance",e[e.LuminanceAlpha=c.GlEnum.LUMINANCE_ALPHA]="LuminanceAlpha",e[e.Rgb=c.GlEnum.RGB]="Rgb",e[e.Rgba=c.GlEnum.RGBA]="Rgba"}(i=exports.TextureFormat||(exports.TextureFormat={})),function(e){e[e.Vertex=c.GlEnum.VERTEX_SHADER]="Vertex",e[e.Fragment=c.GlEnum.FRAGMENT_SHADER]="Fragment"}(u=exports.ShaderType||(exports.ShaderType={})),exports.texturesCount=16,function(e){e[e.NoError=c.GlEnum.NO_ERROR]="NoError",e[e.InvalidEnum=c.GlEnum.INVALID_ENUM]="InvalidEnum",e[e.InvalidValue=c.GlEnum.INVALID_VALUE]="InvalidValue",e[e.InvalidOperation=c.GlEnum.INVALID_OPERATION]="InvalidOperation",e[e.OutOfMemory=c.GlEnum.OUT_OF_MEMORY]="OutOfMemory"}(a=exports.ErrorCode||(exports.ErrorCode={})),function(e){e[e.Stream=c.GlEnum.STREAM_DRAW]="Stream",e[e.Static=c.GlEnum.STATIC_DRAW]="Static",e[e.Dynamic=c.GlEnum.DYNAMIC_DRAW]="Dynamic"}(l=exports.BufferUsage||(exports.BufferUsage={})),function(e){e[e.Array=c.GlEnum.ARRAY_BUFFER]="Array",e[e.Elements=c.GlEnum.ELEMENT_ARRAY_BUFFER]="Elements"}(o=exports.BufferTarget||(exports.BufferTarget={})),function(e){e[e.Points=c.GlEnum.POINTS]="Points",e[e.Lines=c.GlEnum.LINES]="Lines",e[e.LineStrip=c.GlEnum.LINE_STRIP]="LineStrip",e[e.LineLoop=c.GlEnum.LINE_LOOP]="LineLoop",e[e.Triangles=c.GlEnum.TRIANGLES]="Triangles",e[e.TriangleStrip=c.GlEnum.TRIANGLE_STRIP]="TriangleStrip",e[e.TriangleFan=c.GlEnum.TRIANGLE_FAN]="TriangleFan"}(s=exports.PrimitivesType||(exports.PrimitivesType={}));var f,d=function(){function e(e,t){void 0===t&&(t={}),this.settingsCache=f.initial(),this.handle=e.getContext("webgl",t),this.instancedArrays=this.handle.getExtension("ANGLE_instanced_arrays")}return e.prototype.isContextLost=function(){return this.handle.isContextLost()},e.prototype.getPointSizeRange=function(){return this.handle.getParameter(c.GlEnum.ALIASED_POINT_SIZE_RANGE)},e.prototype.cleanColorBuffer=function(){return this.handle.clear(c.GlEnum.COLOR_BUFFER_BIT),this},e.prototype.cleanDepthBuffer=function(){return this.handle.clear(c.GlEnum.DEPTH_BUFFER_BIT),this},e.prototype.cleanBuffers=function(){return this.handle.clear(c.GlEnum.COLOR_BUFFER_BIT|c.GlEnum.DEPTH_BUFFER_BIT),this},e.prototype.drawArrays=function(e,t){return this.handle.drawArrays(e,0,t),this},e.prototype.drawsElements=function(e,t){return this.handle.drawElements(e,t,c.GlEnum.UNSIGNED_SHORT,0),this},e.prototype.drawInstancedArrays=function(e,t,n){return this.instancedArrays.drawArraysInstancedANGLE(e,0,t,n),this},e.prototype.drawsInstancedElements=function(e,t,n){return this.instancedArrays.drawElementsInstancedANGLE(e,t,c.GlEnum.UNSIGNED_SHORT,0,n),this},e.prototype.settings=function(){return new E(this,this.settingsCache)},e.prototype.texture=function(e){return new p(this,e)},e.prototype.arrayBuffer=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=l.Dynamic),new T(this,e,t)},e.prototype.elementsBuffer=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=l.Dynamic),new g(this,e,t)},e.prototype.program=function(e,t){var n=this;return h.uses(function(){return new G(n,u.Vertex,e)},function(){return new G(n,u.Fragment,t)})(function(e,t){return new y(n,e,t)})},e.prototype.dispose=function(){var e=this.handle.getExtension("WEBGL_lose_context");e&&e.loseContext()},e}();exports.Gl=d,function(r){r.initial=function(){return{blend:!1,viewport:[0,0,0,0],scissorTest:!1,scissorBox:[0,0,0,0],depthTest:!1,depthFunction:t.Less,clearDepth:1,lineWidth:1,blendEquation:[e.Add,e.Add],blendFunction:[n.One,n.Zero,n.One,n.Zero],clearColor:[0,0,0,0],activeTexture:0,textures:new Map,arrayBuffer:null,elementsBuffer:null,program:null,enabledAttributes:new Set,instancedAttributes:new Set,renderBuffer:null,frameBuffer:null}}}(f||(f={}));var E=function(){function e(t,n,r){var i,u;void 0===r&&(r=function(e){return e()}),this.gl=t,this.cache=n,this.apply=r,this.blend=e.cached({read:function(e){return e.blend},write:function(e,t){e.blend=t},equals:function(e,t){return e===t},apply:function(e,t){t?e.handle.enable(c.GlEnum.BLEND):e.handle.disable(c.GlEnum.BLEND)}}),this.viewport=(i=e.cached({read:function(e){return e.viewport},write:function(e,t){e.viewport=t},equals:function(e,t){return e.every(function(e,n){return e===t[n]})},apply:function(e,t){var n=t[0],r=t[1],i=t[2],u=t[3];e.handle.viewport(n,r,i,u)}}),function(e,t,n,r){return i.call(this,[e,t,n,r])}),this.scissorTest=e.cached({read:function(e){return e.scissorTest},write:function(e,t){e.scissorTest=t},equals:function(e,t){return e===t},apply:function(e,t){t?e.handle.enable(c.GlEnum.SCISSOR_TEST):e.handle.disable(c.GlEnum.SCISSOR_TEST)}}),this.scissorBox=function(){var t=e.cached({read:function(e){return e.scissorBox},write:function(e,t){e.scissorBox=t},equals:function(e,t){return e.every(function(e,n){return e===t[n]})},apply:function(e,t){var n=t[0],r=t[1],i=t[2],u=t[3];e.handle.scissor(n,r,i,u)}});return function(e,n,r,i){return t.call(this,[e,n,r,i])}}(),this.depthTest=e.cached({read:function(e){return e.depthTest},write:function(e,t){e.depthTest=t},equals:function(e,t){return e===t},apply:function(e,t){t?e.handle.enable(c.GlEnum.DEPTH_TEST):e.handle.disable(c.GlEnum.DEPTH_TEST)}}),this.clearDepth=e.cached({read:function(e){return e.clearDepth},write:function(e,t){e.clearDepth=t},equals:function(e,t){return e===t},apply:function(e,t){e.handle.clearDepth(t)}}),this.lineWidth=e.cached({read:function(e){return e.lineWidth},write:function(e,t){e.lineWidth=t},equals:function(e,t){return e===t},apply:function(e,t){e.handle.lineWidth(t)}}),this.blendEquation=function(){var t=e.cached({read:function(e){return e.blendEquation},write:function(e,t){e.blendEquation=t},equals:function(e,t){return e.every(function(e,n){return e===t[n]})},apply:function(e,t){var n=t[0],r=t[1];e.handle.blendEquationSeparate(n,r)}});return function(e,n){return void 0===n&&(n=e),t.call(this,[e,n])}}(),this.blendFunction=function(){var t=e.cached({read:function(e){return e.blendFunction},write:function(e,t){e.blendFunction=t},equals:function(e,t){return e.every(function(e,n){return e===t[n]})},apply:function(e,t){var n=t[0],r=t[1],i=t[2],u=t[3];e.handle.blendFuncSeparate(n,r,i,u)}});return function(e,n,r,i){return void 0===r&&(r=e),void 0===i&&(i=n),t.call(this,[e,n,r,i])}}(),this.depthFunction=e.cached({read:function(e){return e.depthFunction},write:function(e,t){e.depthFunction=t},equals:function(e,t){return e===t},apply:function(e,t){e.handle.depthFunc(t)}}),this.clearColor=function(){var t=e.cached({read:function(e){return e.clearColor},write:function(e,t){e.clearColor=t},equals:function(e,t){return e.every(function(e,n){return e===t[n]})},apply:function(e,t){var n=t[0],r=t[1],i=t[2],u=t[3];e.handle.clearColor(n,r,i,u)}});return function(e,n,r,i){return t.call(this,[e,n,r,i])}}(),this.activeTexture=e.cached({read:function(e){return e.activeTexture},write:function(e,t){e.activeTexture=t},equals:function(e,t){return e===t},apply:function(e,t){e.handle.activeTexture(c.GlEnum.TEXTURE0+t)}}),this.texture=(u=new Array(16).fill(null).map(function(t,n){return e.cached({read:function(e){return e.textures.get(n)||null},write:function(e,t){t?e.textures.set(n,t):e.textures.delete(n)},equals:function(e,t){return e===t},apply:function(e,t){e.settings().activeTexture(n).apply(function(){e.handle.bindTexture(c.GlEnum.TEXTURE_2D,(null==t?void 0:t.handle)||null)})}})}),function(e,t){return u[e].call(this,t)}),this.arrayBuffer=e.cached({read:function(e){return e.arrayBuffer},write:function(e,t){e.arrayBuffer=t},equals:function(e,t){return e===t},apply:function(e,t){var n;e.handle.bindBuffer(c.GlEnum.ARRAY_BUFFER,null!==(n=null==t?void 0:t.handle)&&void 0!==n?n:null)}}),this.elementsBuffer=e.cached({read:function(e){return e.elementsBuffer},write:function(e,t){e.elementsBuffer=t},equals:function(e,t){return e===t},apply:function(e,t){var n;e.handle.bindBuffer(c.GlEnum.ELEMENT_ARRAY_BUFFER,null!==(n=null==t?void 0:t.handle)&&void 0!==n?n:null)}}),this.program=e.cached({read:function(e){return e.program},write:function(e,t){e.program=t},equals:function(e,t){return e===t},apply:function(e,t){e.handle.useProgram(t?t.handle:null)}}),this.renderBuffer=e.cached({read:function(e){return e.renderBuffer},write:function(e,t){e.renderBuffer=t},equals:function(e,t){return e===t},apply:function(e,t){e.handle.bindRenderbuffer(c.GlEnum.RENDERBUFFER,t?t.handle:null)}}),this.frameBuffer=e.cached({read:function(e){return e.frameBuffer},write:function(e,t){e.frameBuffer=t},equals:function(e,t){return e===t},apply:function(e,t){e.handle.bindFramebuffer(c.GlEnum.FRAMEBUFFER,t?t.handle:null)}})}return e.cached=function(t){var n=t.read,r=t.write,i=t.equals,u=t.apply;return function(t){var a=this;return this.then(new e(this.gl,this.cache,function(e){var l=n(a.cache);if(i(l,t))return e();try{return r(a.cache,t),u(a.gl,t),e()}finally{r(a.cache,l),u(a.gl,l)}}))}},e.prototype.then=function(t){var n=this;return new e(this.gl,this.cache,function(e){return n.apply(function(){return t.apply(e)})})},e.prototype.textures=function(e){for(var t=this,n=0;n<16;n++)t=t.texture(n,n>=e.length?null:e[n]);return t},e.prototype.enabledAttributes=function(t){var n=this;return this.then(new e(this.gl,this.cache,function(e){var r=n.gl.handle,i=n.cache.enabledAttributes,u=new Set(t);n.cache.enabledAttributes=u;var a=function(e,t){for(var n=0,i=e;n<i.length;n++){var u=i[n];t.has(u)||r.disableVertexAttribArray(u)}for(var a=0,l=t;a<l.length;a++){u=l[a];e.has(u)||r.enableVertexAttribArray(u)}};try{return a(i,u),e()}finally{a(u,i),n.cache.enabledAttributes=i}}))},e.prototype.instancedAttributes=function(t){var n=this;return this.then(new e(this.gl,this.cache,function(e){var r=n.gl.instancedArrays,i=n.cache.instancedAttributes,u=new Set(t);n.cache.instancedAttributes=u;var a=function(e,t){for(var n=0,i=e;n<i.length;n++){var u=i[n];t.has(u)||r.vertexAttribDivisorANGLE(u,0)}for(var a=0,l=t;a<l.length;a++){u=l[a];e.has(u)||r.vertexAttribDivisorANGLE(u,1)}};try{return a(i,u),e()}finally{a(u,i),n.cache.instancedAttributes=i}}))},e.prototype.renderTarget=function(t){var n=this;return new e(this.gl,this.cache,function(e){return h.use(new m(n.gl,t),function(r){return n.gl.settings().frameBuffer(r).viewport(0,0,t.width,t.height).apply(e)})})},e}();exports.Settings=E;var p=function(){function e(e,t){var n=this;this.gl=e,this.handle=e.handle.createTexture(),this.format=t.format||i.Rgba,this.filter=t.filter||r.Nearest,"image"in t?(this.width=t.image instanceof HTMLImageElement?t.image.naturalWidth:t.image.width,this.height=t.image instanceof HTMLImageElement?t.image.naturalHeight:t.image.height):(this.width=t.width,this.height=t.height),e.settings().activeTexture(0).texture(0,this).apply(function(){e.handle.pixelStorei(c.GlEnum.UNPACK_FLIP_Y_WEBGL,1),e.handle.texParameteri(c.GlEnum.TEXTURE_2D,c.GlEnum.TEXTURE_MAG_FILTER,n.filter),e.handle.texParameteri(c.GlEnum.TEXTURE_2D,c.GlEnum.TEXTURE_MIN_FILTER,n.filter),e.handle.texParameteri(c.GlEnum.TEXTURE_2D,c.GlEnum.TEXTURE_WRAP_S,c.GlEnum.CLAMP_TO_EDGE),e.handle.texParameteri(c.GlEnum.TEXTURE_2D,c.GlEnum.TEXTURE_WRAP_T,c.GlEnum.CLAMP_TO_EDGE),"image"in t?e.handle.texImage2D(c.GlEnum.TEXTURE_2D,0,n.format,n.format,c.GlEnum.UNSIGNED_BYTE,t.image):e.handle.texImage2D(c.GlEnum.TEXTURE_2D,0,n.format,n.width,n.height,0,n.format,c.GlEnum.UNSIGNED_BYTE,"data"in t?t.data:null)})}return e.prototype.dispose=function(){this.gl.handle.deleteTexture(this.handle)},e}();exports.Texture=p;var m=function(){function e(e,t,n){this.gl=e,this.colorBuffer=t,this.depthBuffer=n,this.handle=e.handle.createFramebuffer(),e.settings().frameBuffer(this).apply(function(){e.handle.framebufferTexture2D(c.GlEnum.FRAMEBUFFER,c.GlEnum.COLOR_ATTACHMENT0,c.GlEnum.TEXTURE_2D,t.handle,0),n&&e.handle.framebufferRenderbuffer(c.GlEnum.FRAMEBUFFER,c.GlEnum.DEPTH_ATTACHMENT,c.GlEnum.RENDERBUFFER,n.handle)})}return e.prototype.dispose=function(){this.gl.handle.deleteFramebuffer(this.handle)},e}();exports.FrameBuffer=m;var A=function(){function e(e,t,n){this.gl=e,this.widthValue=t,this.heightValue=n,this.handle=e.handle.createRenderbuffer(),e.settings().renderBuffer(this).apply(function(){e.handle.renderbufferStorage(c.GlEnum.RENDERBUFFER,c.GlEnum.DEPTH_COMPONENT16,t,n)})}return Object.defineProperty(e.prototype,"width",{get:function(){return this.widthValue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.heightValue},enumerable:!1,configurable:!0}),e.prototype.resize=function(e,t){var n=this.gl;return e===this.width&&t===this.height||(this.widthValue=e,this.heightValue=t,n.settings().renderBuffer(this).apply(function(){n.handle.renderbufferStorage(c.GlEnum.RENDERBUFFER,c.GlEnum.DEPTH_COMPONENT16,e,t)})),this},e.prototype.dispose=function(){this.gl.handle.deleteRenderbuffer(this.handle)},e}();exports.RenderBuffer=A;var T=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=l.Dynamic),this.gl=e,this.usage=n,this.lengthValue=0,this.handle=e.handle.createBuffer(),t&&this.setContent(t)}return Object.defineProperty(e.prototype,"length",{get:function(){return this.lengthValue},enumerable:!1,configurable:!0}),e.prototype.setContent=function(e){var t=this,n=e instanceof Float32Array?e:new Float32Array(e);this.lengthValue=n.length;var r=this.gl;return r.settings().arrayBuffer(this).apply(function(){r.handle.bufferData(WebGL2RenderingContext.ARRAY_BUFFER,n,t.usage)}),this},e.prototype.dispose=function(){this.gl.handle.deleteBuffer(this.handle)},e}();exports.ArrayBuffer=T;var g=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=l.Dynamic),this.gl=e,this.usage=n,this.lengthValue=0,this.handle=e.handle.createBuffer(),t&&this.setContent(t)}return Object.defineProperty(e.prototype,"length",{get:function(){return this.lengthValue},enumerable:!1,configurable:!0}),e.prototype.setContent=function(e){var t=this,n=e instanceof Uint8Array||e instanceof Uint16Array?e:new Uint16Array(e);this.lengthValue=n.length;var r=this.gl;return r.settings().elementsBuffer(this).apply(function(){r.handle.bufferData(WebGL2RenderingContext.ARRAY_BUFFER,n,t.usage)}),this},e.prototype.dispose=function(){this.gl.handle.deleteBuffer(this.handle)},e}();exports.ElementsBuffer=g;var G=function(){function e(e,t,n){this.gl=e,this.type=t,this.source=n;var r=this.handle=e.handle.createShader(t);if(e.handle.shaderSource(r,n),e.handle.compileShader(r),!1===e.handle.getShaderParameter(r,c.GlEnum.COMPILE_STATUS))throw new Error("WebGL error '"+e.handle.getShaderInfoLog(r)+"' in '"+n+"'")}return e.prototype.dispose=function(){this.gl.handle.deleteShader(this.handle)},e}(),y=function(){function e(e,t,n){this.gl=e,this.vertex=t,this.fragment=n,this.uniforms={},this.attributes={};var r=this.handle=e.handle.createProgram();if(e.handle.attachShader(r,t.handle),e.handle.attachShader(r,n.handle),e.handle.linkProgram(r),!1===e.handle.getProgramParameter(r,c.GlEnum.LINK_STATUS))throw new Error(e.handle.getProgramInfoLog(r)||"Program linking error:\n"+t.source+";\n"+n.source);for(var i=e.handle.getProgramParameter(r,c.GlEnum.ACTIVE_UNIFORMS),u=0;u<i;u++){null!==(l=e.handle.getActiveUniform(r,u))&&(this.uniforms[l.name]={type:l.type,location:e.handle.getUniformLocation(r,l.name),size:l.size})}var a=e.handle.getProgramParameter(r,c.GlEnum.ACTIVE_ATTRIBUTES);for(u=0;u<a;u++){var l;null!=(l=e.handle.getActiveAttrib(r,u))&&(this.attributes[l.name]={type:l.type,location:u,size:l.size})}}return e.prototype.setUniform=function(e,t){var n=this.gl,r=this.uniforms[e];if(r){var i=r.location,u=r.type;n.settings().program(this).apply(function(){switch(u){case c.GlEnum.BOOL:n.handle.uniform1i(i,t[0]?1:0);break;case c.GlEnum.SAMPLER_2D:n.handle.uniform1iv(i,t);break;case c.GlEnum.FLOAT:n.handle.uniform1fv(i,t);break;case c.GlEnum.FLOAT_VEC2:n.handle.uniform2fv(i,t);break;case c.GlEnum.FLOAT_VEC3:n.handle.uniform3fv(i,t);break;case c.GlEnum.FLOAT_VEC4:n.handle.uniform4fv(i,t);break;case c.GlEnum.FLOAT_MAT2:n.handle.uniformMatrix2fv(i,!1,t);break;case c.GlEnum.FLOAT_MAT3:n.handle.uniformMatrix3fv(i,!1,t);break;case c.GlEnum.FLOAT_MAT4:n.handle.uniformMatrix4fv(i,!1,t)}})}},e.prototype.setAttribute=function(e,t,n,r){var i=this.attributes[e];if(null!=i){var u=this.gl;u.settings().arrayBuffer(t).apply(function(){u.handle.vertexAttribPointer(i.location,function(){switch(i.type){case c.GlEnum.FLOAT:return 1;case c.GlEnum.FLOAT_VEC2:return 2;case c.GlEnum.FLOAT_VEC3:return 3;case c.GlEnum.FLOAT_VEC4:case c.GlEnum.FLOAT_MAT2:return 4;case c.GlEnum.FLOAT_MAT3:return 9;case c.GlEnum.FLOAT_MAT4:return 16;default:throw new Error("Invalid attribute type '"+i.type+"'")}}(),c.GlEnum.FLOAT,!1,4*n,4*r)})}else console.warn("Attribute '"+e+"' not found")},e.prototype.dispose=function(){this.gl.handle.deleteProgram(this.handle)},e}();exports.Program=y;
},{"./disposable":"pRwy","./enums":"ZRYf"}],"Yoe6":[function(require,module,exports) {
"use strict";var t=this&&this.__assign||function(){return(t=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.val=exports.source=exports.TypeMap=exports.Glsl=exports.GlslBuilder=exports.Precision=exports.Type=void 0;var n,e,r=function(){var t=0;return function(){return t++}}();!function(t){t.Scalar="float",t.Vector2="vec2",t.Matrix2="mat2",t.Vector3="vec3",t.Matrix3="mat3",t.Vector4="vec4",t.Matrix4="mat4",t.Boolean="bool",t.Sampler="sampler2D"}(n=exports.Type||(exports.Type={})),function(t){t.High="highp",t.Medium="mediump",t.Low="lowp"}(e=exports.Precision||(exports.Precision={})),function(t){t.size=function(n){switch(n){case t.Boolean:case t.Scalar:case t.Sampler:return 1;case t.Vector2:case t.Matrix2:return 2;case t.Vector3:case t.Matrix3:return 3;case t.Vector4:case t.Matrix4:return 4}},t.vector=function(n){switch(n){case 2:return t.Vector2;case 3:return t.Vector3;case 4:return t.Vector4}},t.numeric=function(n){switch(n){case 1:return t.Scalar;case 2:return t.Vector2;case 3:return t.Vector3;case 4:return t.Vector4}}}(n=exports.Type||(exports.Type={}));var o=function(){function t(t){void 0===t&&(t=new Map),this.cache=t,this.global="",this.local=""}return t.prototype.once=function(t,n){if(this.cache.has(t))return this.cache.get(t);var e=n();return this.cache.set(t,e),e},t.prototype.getGlobal=function(){return this.global},t.prototype.addGlobal=function(t){return this.global+=t,this},t.prototype.getLocal=function(){return this.local},t.prototype.addLocal=function(t){return this.local+=t,this},t.prototype.child=function(){return new t(this.cache)},t}();exports.GlslBuilder=o;var u,i="==+-*/<><=>=!&&||",c=function(){function t(e){this.getValue=e,this.sin=t.unary("sin"),this.cos=t.unary("cos"),this.radians=t.unary("radians"),this.degrees=t.unary("degrees"),this.tan=t.unary("tan"),this.asin=t.unary("asin"),this.acos=t.unary("acos"),this.exp=t.unary("exp"),this.log=t.unary("log"),this.exp2=t.unary("exp2"),this.log2=t.unary("log2"),this.sqrt=t.unary("sqrt"),this.inversesqrt=t.unary("inversesqrt"),this.abs=t.unary("abs"),this.sign=t.unary("sign"),this.floor=t.unary("floor"),this.ceil=t.unary("floor"),this.fract=t.unary("fract"),this.normalize=t.unary("normalize"),this.not=t.unary("!"),this.texture2D=function(e){return t.call("texture2D",[this,e],function(){return n.Vector4})},this.lt=t.bool("<"),this.gt=t.bool(">"),this.lte=t.bool("<="),this.gte=t.bool(">="),this.eq=t.bool("=="),this.neq=t.bool("!=")}return t.call=function(n,e,r){var o=-1!==i.indexOf(n),u=e.map(function(t){return"number"==typeof t?exports.val(t):t});return 2===e.length&&o?new t(function(t){var e=u.map(function(n){return n.getValue(t)});return{type:r(e.map(function(t){return t.type})),content:"(("+e[0].content+") "+n+" ("+e[1].content+"))"}}):new t(function(t){var e=u.map(function(n){return n.getValue(t)});return{type:r(e.map(function(t){return t.type})),content:n+"("+e.map(function(t){return t.content}).join(", ")+")"}})},t.unary=function(n){return function(){return t.call(n,[this],function(t){return t[0]})}},t.prototype.round=function(){return this.add(.5).floor()},t.prototype.atan=function(n){return void 0===n?t.call("atan",[this],function(t){return t[0]}):t.call("atan",[this,n],function(t){return t[0]})},t.prototype.pow=function(n){var e="number"==typeof n?exports.val(n):n;return t.call("pow",[this,e],function(t){return t[0]})},t.prototype.mod=function(n){var e="number"==typeof n?exports.val(n):n;return t.call("mod",[this,e],function(t){return t[0]})},t.prototype.min=function(n){var e="number"==typeof n?exports.val(n):n;return t.call("min",[this,e],function(t){return t[0]})},t.prototype.max=function(n){return t.call("max",[this,n],function(t){return t[0]})},t.prototype.mix=function(n,e){return t.call("mix",[this,n,e],function(t){return t[0]})},t.prototype.clamp=function(n,e){return t.call("clamp",[this,n,e],function(t){return t[0]})},t.prototype.smoothstep=function(n,e){return t.call("smoothstep",[n,e,this],function(t){return t[0]})},t.prototype.length=function(){return t.call("length",[this],function(){return n.Scalar})},t.prototype.distance=function(e){return t.call("distance",[this,e],function(){return n.Scalar})},t.prototype.dot=function(e){return t.call("dot",[this,e],function(){return n.Scalar})},t.prototype.reflect=function(n){return t.call("reflect",[this,n],function(t){return t[0]})},t.prototype.refract=function(n,e){return t.call("refract",[this,n,e],function(t){return t[0]})},t.prototype.add=function(n){return t.call("+",[this,n],function(t){return t[0]})},t.prototype.sub=function(n){return t.call("-",[this,n],function(t){return t[0]})},t.prototype.div=function(n){return t.call("+",[this,n],function(t){return t[0]})},t.prototype.mul=function(n){return t.call("*",[this,n],function(t){return t[0]})},t.bool=function(e){return function(r){return t.call(e,[this,r],function(){return n.Boolean})}},t.prototype.and=function(e){return t.call("&&",[this,e],function(){return n.Boolean})},t.prototype.or=function(e){return t.call("||",[this,e],function(){return n.Boolean})},t.prototype.mem=function(n){var e=this,o="mem"+r();return new t(function(t){var r=e.getValue(t);return t.once(o,function(){t.addLocal(n+" "+r.type+" "+o+" = "+r.content+";\n")}),{type:r.type,content:o}})},t.prototype.memHQ=function(){return this.mem(e.High)},t.prototype.memMQ=function(){return this.mem(e.Medium)},t.prototype.memLQ=function(){return this.mem(e.Low)},t.prototype.cond=function(e,o,u){var i=this,c="cond"+r(),a=null;return new t(function(t){return t.once(c,function(){var r=t.child(),s=o.getValue(r),l=t.child(),p=u.getValue(l),f=i.getValue(t);a=s.type,t.addGlobal(r.getGlobal()).addGlobal(l.getGlobal()),t.addLocal((s.type!==n.Boolean?e+" ":"")+s.type+" "+c+";\n").addLocal("if ("+f.content+") {\n").addLocal(r.getLocal()).addLocal(c+" = "+s.content+";\n").addLocal("} else {\n").addLocal(l.getLocal()).addLocal(c+" = "+p.content+";\n").addLocal("}\n")}),{type:a,content:c}})},t.prototype.condHQ=function(t,n){return this.cond(e.High,t,n)},t.prototype.condMQ=function(t,n){return this.cond(e.Medium,t,n)},t.prototype.condLQ=function(t,n){return this.cond(e.Low,t,n)},t.prototype.take=function(e,r,o,u){var i=this;return new t(function(t){var c=[e,r,o,u].filter(function(t){return void 0!==t}),a=i.getValue(t);return{type:1===c.length?n.Scalar:n.vector(c.length),content:"("+a.content+")."+c.map(function(t){return"xyzw".charAt(t)}).join("")}})},t.prototype.x=function(){return this.take(0)},t.prototype.y=function(){return this.take(1)},t.prototype.z=function(){return this.take(2)},t.prototype.w=function(){return this.take(3)},t.prototype.r=function(){return this.take(0)},t.prototype.g=function(){return this.take(1)},t.prototype.b=function(){return this.take(2)},t.prototype.a=function(){return this.take(3)},t.prototype.cat=function(e){var r=this;return"number"==typeof e?this.cat(t.val(e)):new t(function(t){var o=r.getValue(t),u=e.getValue(t),i=n.numeric(n.size(o.type)+n.size(u.type));return{type:i,content:i+"("+o.content+", "+u.content+")"}})},t.val=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(1===e.length){if("boolean"==typeof e[0])return new t(function(){return{type:n.Boolean,content:e[0]?"1":"0"}});if(e[0]instanceof t)return e[0];var o=e[0].toString();return new t(function(){return{type:n.Scalar,content:/[e\.]/.test(o)?o:o+".0"}})}if(e.some(function(t){return"number"==typeof t})){var u=e.map(function(n){return t.val(n)});return t.val.apply(null,u)}return e.reduce(function(t,n){return t.cat(n)})},t.PI=t.val(Math.PI),t}();function a(e){var r=e.uniforms,i=e.attributes,a=e.varyings,s=e.instances,l=e.fragment,p=e.vertex,f=u.values("uniform",r),h=u.values("attribute",t(t({},i),s)),y=a?u.values("varying",a):{},g=new o;Object.keys(y).forEach(function(t){y[t].getValue(g)});var d=p(t(t({},f),h)),v=Object.keys(d).map(function(t){return t+" = "+d[t].getValue(g).content+";\n"}).join(""),m=g.getGlobal()+"void main() {\n"+g.getLocal()+v+"}\n",x=new o;Object.keys(y).forEach(function(t){y[t].getValue(g)});var b=l(t(t(t({},f),y),{gl_FragCoord:new c(function(){return{type:n.Vector4,content:"gl_FragCoord"}}),gl_PointCoord:new c(function(){return{type:n.Vector2,content:"gl_FragCoord"}}),gl_FrontFacing:new c(function(){return{type:n.Boolean,content:"gl_FrontFacing"}})})).gl_FragColor.getValue(x);return{vertex:m,fragment:x.getGlobal()+"void main() {\n"+x.getLocal()+"gl_FragColor = "+b.content+";\n}\n",uniforms:u.withoutPrecision(r),attributes:u.withoutPrecision(i),instances:u.withoutPrecision(s)}}exports.Glsl=c,function(t){function r(t){return Array.isArray(t)?t[0]:t}function o(t){var e=0;for(var o in t)e+=n.size(r(t[o]));return e}t.getType=r,t.getPrecision=function(t){return Array.isArray(t)?t[1]:e.High},t.withoutPrecision=function(t){return Object.keys(t).reduce(function(n,e){return n[e]=r(t[e]),n},{})},t.values=function(n,e){var r={};return Object.keys(e).forEach(function(o){var u=e[o];r[o]=new c(function(e){return e.once("types_map_value_"+o,function(){e.addGlobal(n+" "+t.getPrecision(u)+" "+t.getType(u)+" "+o+";\n")}),{type:t.getType(u),content:o}})}),r},t.stride=o,t.layout=function(t){var e=o(t);return Object.keys(t).reduce(function(o,u){var i=o.length?o[o.length-1]:null;return o.push({name:u,stride:e,size:n.size(r(t[u])),offset:i?i.offset+i.size:0}),o},[])}}(u=exports.TypeMap||(exports.TypeMap={})),exports.source=a,exports.val=c.val;
},{}],"jGoF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.command=void 0;var t=require("./dsl"),e=require("./webgl"),r=function(){function r(e,r,s){var i=this;for(var n in this.gl=e,this.primitivesType=r,this.source=s,this.textureInstances=new Map,this.textureIndexes=new Map,this.program=e.program(s.vertex,s.fragment),this.attributes=e.arrayBuffer(),this.instances=e.arrayBuffer(),this.elements=e.elementsBuffer(),this.attributesStride=t.TypeMap.stride(s.attributes),this.attributesLayout=t.TypeMap.layout(s.attributes),this.instancesStride=t.TypeMap.stride(s.instances),this.instancesLayout=t.TypeMap.layout(s.instances),this.attributesLayout.forEach(function(t){i.program.setAttribute(t.name,i.attributes,t.stride,t.offset)}),this.instancesLayout.forEach(function(t){i.program.setAttribute(t.name,i.attributes,t.stride,t.offset)}),s.uniforms)t.TypeMap.getType(s.uniforms[n])===t.Type.Sampler&&this.textureIndexes.set(n,this.textureIndexes.size)}return r.prototype.prepareData=function(t,e,r){var s=this,i=new Float32Array(t*r.length);return r.forEach(function(e,r){var n=t*r;s.attributesLayout.forEach(function(t){var r=e[t.name];if(Array.isArray(r))for(var s=0;s<r.length;s++)i[n+s]=r[s];else if(2===t.size){var a=r,o=a.x,u=a.y;i[n]=o,i[n+1]=u}else{if(3!==t.size)throw new Error("Unsupported attribute '"+t.name+"' value: "+JSON.stringify(r));var p=r,f=(o=p.x,u=p.y,p.z);i[n]=o,i[n+1]=u,i[n+2]=f}})}),i},r.prototype.setAttributes=function(t){var e=this.prepareData(this.attributesStride,this.attributesLayout,t);return this.attributes.setContent(e),this},r.prototype.setInstances=function(t){var e=this.prepareData(this.instancesStride,this.instancesLayout,t);return this.instances.setContent(e),this},r.prototype.setElements=function(t){return this.elements.setContent(t),this},r.prototype.setUniforms=function(r){var s=this.source.uniforms;for(var i in r){var n=r[i],a=void 0;if("number"==typeof n)a=[n];else if(Array.isArray(n))a=n;else if(n instanceof e.Texture){var o=this.textureIndexes.get(i);this.textureInstances.set(o,n),a=[o]}else if(s[i]===t.Type.Vector2){var u=n;a=[u.x,u.y]}else{if(s[i]!==t.Type.Vector3)throw new Error("Invalid value for uniform '"+i+"', expected "+s[i]);var p=n;a=[p.x,p.y,p.z]}this.program.setUniform(i,a)}return this},r.prototype.draw=function(t,e,r){var s=this;void 0===t&&(t=this.instancesStride?this.instances.length/this.instancesStride:null),void 0===e&&(e=this.attributesStride?this.attributes.length/this.attributesStride:null),void 0===r&&(r=this.elements.length);var i=this.gl;i.settings().program(this.program).enabledAttributes(Object.keys(this.program.attributes).map(function(t){var e;return null===(e=s.program.attributes[t])||void 0===e?void 0:e.location}).filter(function(t){return null!=t})).instancedAttributes(this.instancesLayout.map(function(t){return t.name}).map(function(t){var e;return null===(e=s.program.attributes[t])||void 0===e?void 0:e.location}).filter(function(t){return null!=t})).textures(Array.from(this.textureInstances.entries()).reduce(function(t,e){var r=e[0],s=e[1];return t[r]=s,t},new Array(16).fill(null))).apply(function(){if(null!==t&&0!==r)i.settings().elementsBuffer(s.elements).apply(function(){i.drawsInstancedElements(s.primitivesType,r,t)});else if(null!==t&&null!==e)i.drawInstancedArrays(s.primitivesType,e,t);else if(0!==r)i.settings().elementsBuffer(s.elements).apply(function(){i.drawsElements(s.primitivesType,r)});else{if(!e)throw new Error("Invalid draw dataset");i.drawArrays(s.primitivesType,e)}})},r.prototype.dispose=function(){this.program.dispose(),this.attributes.dispose(),this.instances.dispose(),this.elements.dispose()},r}();function s(e,s,i){return new r(e,s,t.source(i))}exports.command=s;
},{"./dsl":"Yoe6","./webgl":"k6Ze"}],"QCba":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,t,i){void 0===i&&(i=t),Object.defineProperty(e,i,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,i){void 0===i&&(i=t),e[i]=r[t]}),r=this&&this.__exportStar||function(r,t){for(var i in r)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||e(t,r,i)};Object.defineProperty(exports,"__esModule",{value:!0}),r(require("./webgl"),exports),r(require("./dsl"),exports),r(require("./command"),exports),r(require("./disposable"),exports);
},{"./webgl":"k6Ze","./dsl":"Yoe6","./command":"jGoF","./disposable":"pRwy"}]},{},["QCba"], null)
//# sourceMappingURL=/index.js.map